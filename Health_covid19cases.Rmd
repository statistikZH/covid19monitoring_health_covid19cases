---
title: "R Notebook"
---

# R setup

```{r}

# Import libraries
library(dplyr) # Version: ‘0.8.5’
library(tidyr) # ‘1.0.2’

# Number formatting
options(scipen = 1000000)
options(digits = 6)

```

# import dat

```{r}

#cases
url_cases  <- "https://raw.githubusercontent.com/openZH/covid_19/master/fallzahlen_kanton_total_csv/COVID19_Fallzahlen_Kanton_ZH_total.csv"
cases <- read.csv(url(url_cases), header=T, sep=",", stringsAsFactors=FALSE, encoding="UTF-8")

```

```{r}

cases_sel <- cases %>%
  select(date, ncumul_conf, ncumul_deceased) %>%
  mutate(
  ncumul_conf = ifelse(is.na(ncumul_conf), 0, ncumul_conf),
  ncumul_deceased = ifelse(is.na(ncumul_deceased), 0 , ncumul_deceased),
  sarscov2_faelle = ifelse(date == "2020-02-27"	, ncumul_conf,  ncumul_conf - lag(ncumul_conf, n = 1)),
  sarscov2_verstorbene = ifelse(date == "2020-02-27"	, ncumul_deceased,  ncumul_deceased - lag(ncumul_deceased, n = 1))
  ) %>%
  pivot_longer(
  cols = c(sarscov2_faelle, sarscov2_verstorbene),
  names_to = "variable_short",
  values_to = "value"
  ) %>%
  mutate(
      variable_long = case_when(
      variable_short == "sarscov2_faelle" ~  "Gemeldete Anzahl von bestätigten SARS-CoV-2 Fällen",
      variable_short == "sarscov2_verstorbene" ~  "Gemeldete Anzahl von bestätigten SARS-CoV-2 Versroebenen ",
      TRUE ~ "???"),
    topic = "Gesundheit",
    location = "ZH",
    unit= "Anzahl",
    source = "Gesundheitsdirektion Kanton Zürich",
    update = "täglich",
    public = "ja",
    description = "	https://github.com/statistikZH/covid19moitoring_health_covid19cases"
  ) %>%
  select(-ncumul_conf, -ncumul_deceased) %>%
  select(date, value, topic, variable_short, variable_long, location, unit, source, update, public, description) 
														
```

# export result

```{r}

write.table(cases_sel, "./Gesundheit_covid19cases.csv", sep=",", fileEncoding="UTF-8", row.names = F)


```

# auffälligkeiten

sarscov2_verstorbene: <br>
-1 am 17.03.2020  <br>
0 am 18.03.2020  <br>
